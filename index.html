<!DOCTYPE html>
<html>
  <head>
    <title>Водні об'єкти Донецької області</title>
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js"></script>

    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js"></script>
    <link
      href="https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css"
      rel="stylesheet"
    />

    <script src="https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js"></script>

    <script src="./data-2.js"></script>

    <style>
      .scrollable-menu {
        height: auto;
        max-height: 400px;
        overflow-x: hidden;
      }

      .map {
        position: absolute;
        left: 0%;
        top: 8%;
        bottom: 0%;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container-fluid">
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" id="link-14" aria-current="page" href="#"
                >Донецька область</a
              >
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle active"
                href="#"
                id="navbarDropdownMenuLink"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Бахмутський р-н
              </a>
              <ul
                class="dropdown-menu scrollable-menu"
                aria-labelledby="navbarDropdownMenuLink"
              >
                <li>
                  <a
                    class="dropdown-item dropdown-events"
                    id="link-101"
                    href="#"
                    >Бахмутська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-102" href="#"
                    >Званівська територіальна громада
                    <span class="badge bg-info text-dark">4</span></a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-103" href="#"
                    >Світлодарська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-104" href="#"
                    >Сіверська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-105" href="#"
                    >Соледарська територіальна громада
                    <span class="badge bg-info text-dark">4</span></a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-106" href="#"
                    >Торецька територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-107" href="#"
                    >Часовоярська територіальна громада</a
                  >
                </li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle active"
                href="#"
                id="navbarDropdownMenuLink"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Волноваський р-н
              </a>
              <ul
                class="dropdown-menu scrollable-menu"
                aria-labelledby="navbarDropdownMenuLink"
              >
                <li>
                  <a
                    class="dropdown-item dropdown-events"
                    id="link-201"
                    href="#"
                    >Великоновосілківська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-202" href="#"
                    >Волноваська територіальна громада
                    <span class="badge bg-info text-dark">4</span></a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-203" href="#"
                    >Вугледарська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-204" href="#"
                    >Комарська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-205" href="#"
                    >Мирненська територіальна громада
                    <span class="badge bg-info text-dark">4</span></a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-206" href="#"
                    >Ольгинська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-207" href="#"
                    >Старомлинівська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-208" href="#"
                    >Хлібодарівська територіальна громада</a
                  >
                </li>
              </ul>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle active"
                href="#"
                id="navbarDropdownMenuLink"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Краматорський р-н
              </a>
              <ul
                class="dropdown-menu scrollable-menu"
                aria-labelledby="navbarDropdownMenuLink"
              >
                <li>
                  <a
                    class="dropdown-item dropdown-events"
                    id="link-301"
                    href="#"
                    >Андріївська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" 
                  id="link-302" href="#"
                    >Дружківська територіальна громада
                    <span class="badge bg-info text-dark">4</span></a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-303" href="#"
                    >Іллінівська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-304" href="#"
                    >Костянтинівська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-305" href="#"
                    >Краматорська територіальна громада
                    <span class="badge bg-info text-dark">4</span></a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-306" href="#"
                    >Лиманська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-307" href="#"
                    >Миколаївська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-308" href="#"
                    >Новодонецька територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-309" href="#"
                    >Олександрівська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-310" href="#"
                    >Святогірська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-311" href="#"
                    >Слов'янська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-312" href="#"
                    >Черкаська територіальна громада</a
                  >
                </li>
              </ul>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle active"
                href="#"
                id="navbarDropdownMenuLink"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Маріупольський р-н
              </a>
              <ul
                class="dropdown-menu scrollable-menu"
                aria-labelledby="navbarDropdownMenuLink"
              >
                <li>
                  <a
                    class="dropdown-item dropdown-events"
                    id="link-401"
                    href="#"
                    >Кальчицька територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-402" href="#"
                    >Мангушська територіальна громада
                    <span class="badge bg-info text-dark">4</span></a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-403" href="#"
                    >Маріупольська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-404" href="#"
                    >Нікольська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-405" href="#"
                    >Сартанська територіальна громада
                    <span class="badge bg-info text-dark">4</span></a
                  >
                </li>
              </ul>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle active"
                href="#"
                id="navbarDropdownMenuLink"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Покровський р-н
              </a>
              <ul
                class="dropdown-menu scrollable-menu"
                aria-labelledby="navbarDropdownMenuLink"
              >
                <li>
                  <a
                    class="dropdown-item dropdown-events"
                    id="link-501"
                    href="#"
                    >Авдіївська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-502" href="#"
                    >Білозерська територіальна громада
                    <span class="badge bg-info text-dark">4</span></a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-503" href="#"
                    >Гродівська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-504" href="#"
                    >Добропільська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-505" href="#"
                    >Криворізька територіальна громада
                    <span class="badge bg-info text-dark">4</span></a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-506" href="#"
                    >Курахівська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-507" href="#"
                    >Мар'їнська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-508" href="#"
                    >Мирноградська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-509" href="#"
                    >Новогродівська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-510" href="#"
                    >Очеретинська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-511" href="#"
                    >Покровська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-512" href="#"
                    >Селидівська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-513" href="#"
                    >Удачненська територіальна громада</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" id="link-514" href="#"
                    >Шахівська територіальна громада</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div id="map" class="map"></div>

    <script>

      mapboxgl.accessToken = 'pk.eyJ1Ijoic2VyZ2lvYWRtMzIxIiwiYSI6ImNrcWo3MjYxajA4dmkzMG54dHQ3eHM1ancifQ.7aDWVU3oOhZJcbXNur8wYw';
      
      // var my_geojson = $.getJSON("https://sergioadmin.github.io/GTB/TG_Don-2-polygons.geojson");
      console.log(my_geojson);


      // var result = $.ajax({
      //   type: 'GET',
      //   dataType: 'json',
      //   url: "https://sergioadmin.github.io/GTB/TG_Don-2-polygons.geojson",
      //   success: function(obj) {
      //       console.log('Stop-1'+obj);

    // for(i=302;i<313;i++) {
    //   name_id = 'link-'+String(i); 
    //   link = document.getElementById(name_id);
    //   selected_id=i;
    //   eval(link.addEventListener('click', function () {
    //     selected_id=i;
    //     var features = my_geojson.features;
    //     for(var j=0; j<features.length;j++) {
    //       if(parseInt(features[j].properties.id) == selected_id){
    //         map.setFilter('tg_highlighted',["==",'id',selected_id]);
    //         var bbox = turf.extent(features[j]);
    //         map.fitBounds(bbox, {padding: 20});
    //       }
    //     }
    //   })
    // );
    // }

            // return obj;
      //   },
      //   error: function(obj) {
      //     alert('Error-1111');
      //   }
      // });

      // var mj = result;
      console.log('Stop-2');
            /**
             * Add the map to the page
             */
            const map = new mapboxgl.Map({
              container: 'map',
              style: 'mapbox://styles/sergioadm321/ckrmy7urs47km17mswprklptd/draft',
              center: [36.83012, 47.84091],
              zoom: 10,
              scrollZoom: true
            });

      map.on('load', () => {
        map.addSource('don_tg', {
          type: 'geojson',
          // Use a URL for the value for the `data` property.
          // data: 'https://sergioadmin.github.io/GTB/TG_Don-2.geojson'
          // my_geojson.responseJSON
          data: my_geojson
          // data: 'https://sergioadmin.github.io/GTB/TG_Don-2-polygons.geojson'
        });

        map.addLayer({
          'id': 'tg_highlighted',
          'type': 'line',
          'source': 'don_tg',
          'paint': {
            'line-color': '#f46d43',
            'line-width': 6
          },
          'filter': ["==",'id',900]
        });

        map.addLayer({
          'id': 'don_tg-layer',
          'type': 'line',
          'source': 'don_tg',
           'paint': {
              'line-color': '#000',
              'line-width': 3
            }
        });

});

    let geo_len = my_geojson.features.map(feature => feature.properties.id);
    geo_len.forEach( function(i) {
      name_id = 'link-'+String(i); 
      link = document.getElementById(name_id);
      selected_id=i;
      link.addEventListener('click', ff12(selected_id) );
    });

function ff12(selected_id1) {
  return function e() {
    // console.log(selected_id);
    for(var j=0; j<my_geojson.features.length;j++){
      if(parseInt(my_geojson.features[j].properties.id) == selected_id1){
        map.setFilter('tg_highlighted',["==",'id',selected_id1]);
        var bbox = turf.extent(my_geojson.features[j]);
        map.fitBounds(bbox, {padding: 20});
        // return;
      }
    }  
  }
}
    </script>
  </body>
</html>
